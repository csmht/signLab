# SignLab1 é¡¹ç›®æ–‡æ¡£

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [ç¯å¢ƒé…ç½®](#ç¯å¢ƒé…ç½®)
- [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
- [APIæ–‡æ¡£](#apiæ–‡æ¡£)
- [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
- [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
- [æµ‹è¯•æŒ‡å—](#æµ‹è¯•æŒ‡å—)
- [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## é¡¹ç›®æ¦‚è¿°

**SignLab1** æ˜¯ä¸€ä¸ªåŸºäº Spring Boot çš„æ•™è‚²ç®¡ç†ç³»ç»Ÿï¼Œä¸“æ³¨äºå­¦ç”Ÿè€ƒå‹¤ä¸è¯¾å ‚äº’åŠ¨ã€‚ç³»ç»Ÿæä¾›äºŒç»´ç ç­¾åˆ°ã€è¯¾å ‚ç…§ç‰‡ä¸Šä¼ ã€ä½œä¸šæäº¤ã€è¯¾ç¨‹æˆç»©ç®¡ç†ã€é—®å·ç³»ç»Ÿä»¥åŠå¾®ä¿¡å…¬ä¼—å·é›†æˆç­‰åŠŸèƒ½ã€‚

### ä¸»è¦åŠŸèƒ½

- âœ… **å­¦ç”Ÿç­¾åˆ°ç®¡ç†** - äºŒç»´ç ç­¾åˆ°ï¼Œæ”¯æŒè·¨ç­ç­¾åˆ°
- âœ… **è¯¾å ‚ç…§ç‰‡ç®¡ç†** - å­¦ç”Ÿä¸Šä¼ è¯¾å ‚ç…§ç‰‡ï¼Œè‡ªåŠ¨å‹ç¼©
- âœ… **ä½œä¸šæäº¤ä¸æ‰¹æ”¹** - æ”¯æŒå¤šç§ä½œä¸šç±»å‹
- âœ… **è¯¾ç¨‹æˆç»©ç®¡ç†** - æˆç»©å½•å…¥ä¸æŸ¥è¯¢
- âœ… **é—®å·/è¯•å·ç³»ç»Ÿ** - æ”¯æŒå¤šç§é¢˜å‹çš„é—®å·å’Œè€ƒè¯•
- âœ… **å¾®ä¿¡å…¬ä¼—å·é›†æˆ** - å¾®ä¿¡ç™»å½•ã€æ¶ˆæ¯é€šçŸ¥
- âœ… **å¤šç­çº§è¯¾ç¨‹æ”¯æŒ** - ä¸€ä¸ªè¯¾ç¨‹å¯å…³è”å¤šä¸ªç­çº§
- âœ… **Wordæ–‡æ¡£ç”Ÿæˆ** - è‡ªåŠ¨ç”Ÿæˆè¯¾å ‚ç¬”è®°Wordæ–‡æ¡£

---

## æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯

| æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| Java | 17 | å¼€å‘è¯­è¨€ |
| Spring Boot | 3.5.5 | åº”ç”¨æ¡†æ¶ |
| Spring Security | - | å®‰å…¨æ¡†æ¶ |
| Spring AOP | - | åˆ‡é¢ç¼–ç¨‹ |
| MyBatis Plus | 3.5.9-EXT727 | ORMæ¡†æ¶ |
| AutoTable | 2.5.0 | è‡ªåŠ¨å»ºè¡¨ |
| JWT | jjwt 0.11.5 | è®¤è¯ä»¤ç‰Œ |
| Apache POI | 5.2.4 | Excel/Wordå¤„ç† |
| EasyExcel | 3.1.2 | Excelå¤„ç† |
| ZXing | 3.5.2 | äºŒç»´ç ç”Ÿæˆ |
| Thymeleaf | - | æ¨¡æ¿å¼•æ“ |
| Lombok | 1.18.30 | ä»£ç ç®€åŒ– |

### æ•°æ®åº“

- **MySQL** 8.0+

### å¼€å‘å·¥å…·

- **Maven** - é¡¹ç›®æ„å»º
- **Python** 3.13.2 - æµ‹è¯•è„šæœ¬

---

## ç³»ç»Ÿæ¶æ„

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å®¢æˆ·ç«¯å±‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Webå‰ç«¯ â”‚  â”‚  å¾®ä¿¡å°ç¨‹åºâ”‚  â”‚  ç§»åŠ¨ç«¯  â”‚  â”‚  æµ‹è¯•è„šæœ¬ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Controller å±‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚AuthCtrl  â”‚  â”‚TeacherCtrlâ”‚ â”‚StudentCtrlâ”‚ â”‚Assignment â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Service å±‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚UserServiceâ”‚ â”‚CourseServiceâ”‚ â”‚AttendanceServiceâ”‚ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Mapper å±‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚UserMapperâ”‚ â”‚CourseMapperâ”‚ â”‚AttendanceMapperâ”‚ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MySQL æ•°æ®åº“                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å®‰å…¨ä¸å·¥å…·å±‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚JwtAuthentication â”‚  â”‚RoleValidation    â”‚  â”‚JwtUtil   â”‚  â”‚
â”‚  â”‚Filter            â”‚  â”‚Aspect            â”‚  â”‚SecurityUtilâ”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åˆ†å±‚è¯´æ˜

| å±‚çº§ | èŒè´£ |
|------|------|
| **Controllerå±‚** | å¤„ç†HTTPè¯·æ±‚ï¼Œå‚æ•°éªŒè¯ï¼Œè¿”å›å“åº” |
| **Serviceå±‚** | ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œäº‹åŠ¡ç®¡ç† |
| **Mapperå±‚** | æ•°æ®åº“æ“ä½œï¼ŒSQLæ˜ å°„ |
| **Entityå±‚** | æ•°æ®åº“å®ä½“æ˜ å°„ |
| **DTOå±‚** | æ•°æ®ä¼ è¾“å¯¹è±¡ |
| **VOå±‚** | è§†å›¾å¯¹è±¡ |

### è®¾è®¡æ¨¡å¼

- **AOPåˆ‡é¢ç¼–ç¨‹** - è§’è‰²éªŒè¯
- **ä¾èµ–æ³¨å…¥** - Spring IoC
- **è½¯åˆ é™¤æ¨¡å¼** - æ•°æ®ä¿ç•™
- **JWTæ— çŠ¶æ€è®¤è¯** - è·¨åŸŸæ”¯æŒ

---

## å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Java 17+
- Maven 3.6+
- MySQL 8.0+
- Python 3.13.2+ (å¯é€‰ï¼Œç”¨äºæµ‹è¯•)

### å…‹éš†é¡¹ç›®

```bash
git clone <repository-url>
cd signLab1
```

### é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `local-config.env` æ–‡ä»¶ï¼š

```env
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=3306
DB_NAME=signlab1
DB_USERNAME=root
DB_PASSWORD=your_password

# æ–‡ä»¶ä¸Šä¼ è·¯å¾„
UPLOAD_PATH=./uploads

# JWTé…ç½®
JWT_SECRET=your_jwt_secret_key
JWT_EXPIRATION=2592000

# æœåŠ¡å™¨é…ç½®
SERVER_PORT=8085
SERVER_ADDRESS=0.0.0.0

# å¾®ä¿¡é…ç½®
WECHAT_APPID=your_wechat_appid
WECHAT_SECRET=your_wechat_secret
WECHAT_TEMPLATE_ID=your_template_id
WECHAT_TOKEN=your_wechat_token
```

### åˆå§‹åŒ–æ•°æ®åº“

```bash
# åˆ›å»ºæ•°æ®åº“
mysql -u root -p -e "CREATE DATABASE IF NOT EXISTS signlab1 CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"

# æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬
mysql -u root -p signlab1 < database/signlab1_init.sql
```

### å¯åŠ¨åº”ç”¨

**Windows:**
```bash
start-simple.vbs
```

**Linux/Mac:**
```bash
chmod +x start.sh
./start.sh
```

**Mavenå‘½ä»¤:**
```bash
mvn clean install
mvn spring-boot:run
```

### éªŒè¯å¯åŠ¨

è®¿é—®å¥åº·æ£€æŸ¥æ¥å£ï¼š
```bash
curl http://localhost:8085/api/health/check
```

---

## ç¯å¢ƒé…ç½®

### é…ç½®æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `application.yml` | ä¸»é…ç½®æ–‡ä»¶ |
| `application-prod.yml` | ç”Ÿäº§ç¯å¢ƒé…ç½® |
| `application-text.yml` | æ–‡æœ¬ç¯å¢ƒé…ç½® |
| `logback-spring.xml` | æ—¥å¿—é…ç½® |

### ä¸»è¦é…ç½®é¡¹

```yaml
# æ•°æ®æºé…ç½®
spring:
  datasource:
    url: jdbc:mysql://${DB_HOST}:${DB_PORT}/${DB_NAME}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}

# æ–‡ä»¶ä¸Šä¼ é…ç½®
spring:
  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 10MB

# MyBatis Plusé…ç½®
mybatis-plus:
  configuration:
    map-underscore-to-camel-case: true
  global-config:
    db-config:
      logic-delete-field: isDeleted
      logic-delete-value: 1
      logic-not-delete-value: 0

# JWTé…ç½®
jwt:
  secret: ${JWT_SECRET}
  expiration: ${JWT_EXPIRATION}

# æ–‡ä»¶è·¯å¾„é…ç½®
file:
  upload:
    path: ${UPLOAD_PATH}
    photo:
      path: ${file.upload.path}photos/
    document:
      path: ${file.upload.path}documents/

# å¾®ä¿¡é…ç½®
wechat:
  appid: ${WECHAT_APPID}
  secret: ${WECHAT_SECRET}
  template-id: ${WECHAT_TEMPLATE_ID}
  token: ${WECHAT_TOKEN}
```

---

## æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒæ•°æ®è¡¨

#### users - ç”¨æˆ·è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | BIGINT | ä¸»é”® |
| username | VARCHAR(50) | ç”¨æˆ·å |
| password | VARCHAR(255) | å¯†ç  |
| name | VARCHAR(100) | å§“å |
| role | VARCHAR(20) | è§’è‰² |
| wx_openid | VARCHAR(100) | å¾®ä¿¡OpenID |
| wx_unionid | VARCHAR(100) | å¾®ä¿¡UnionID |
| wx_nickname | VARCHAR(100) | å¾®ä¿¡æ˜µç§° |
| wx_avatar | VARCHAR(500) | å¾®ä¿¡å¤´åƒ |
| wx_bind_time | DATETIME | ç»‘å®šæ—¶é—´ |
| is_deleted | INT | è½¯åˆ é™¤æ ‡è®° |
| create_time | DATETIME | åˆ›å»ºæ—¶é—´ |
| update_time | DATETIME | æ›´æ–°æ—¶é—´ |

#### classes - ç­çº§è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | BIGINT | ä¸»é”® |
| class_code | VARCHAR(50) | ç­çº§ç¼–ç  |
| class_name | VARCHAR(100) | ç­çº§åç§° |
| verification_code | VARCHAR(50) | éªŒè¯ç  |
| is_deleted | INT | è½¯åˆ é™¤æ ‡è®° |
| create_time | DATETIME | åˆ›å»ºæ—¶é—´ |
| update_time | DATETIME | æ›´æ–°æ—¶é—´ |

#### courses - è¯¾ç¨‹è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | BIGINT | ä¸»é”® |
| course_id | VARCHAR(50) | è¯¾ç¨‹ID |
| course_name | VARCHAR(100) | è¯¾ç¨‹åç§° |
| teacher_username | VARCHAR(50) | æ•™å¸ˆç”¨æˆ·å |
| class_code | VARCHAR(50) | ç­çº§ç¼–ç  |
| course_date | DATE | è¯¾ç¨‹æ—¥æœŸ |
| start_time | TIME | å¼€å§‹æ—¶é—´ |
| end_time | TIME | ç»“æŸæ—¶é—´ |
| location | VARCHAR(100) | åœ°ç‚¹ |
| is_deleted | INT | è½¯åˆ é™¤æ ‡è®° |
| create_time | DATETIME | åˆ›å»ºæ—¶é—´ |
| update_time | DATETIME | æ›´æ–°æ—¶é—´ |

#### attendance_records - ç­¾åˆ°è®°å½•è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | BIGINT | ä¸»é”® |
| course_id | VARCHAR(50) | è¯¾ç¨‹ID |
| student_username | VARCHAR(50) | å­¦ç”Ÿç”¨æˆ·å |
| student_actual_class_code | VARCHAR(50) | å­¦ç”Ÿå®é™…ç­çº§ |
| is_cross_class | INT | æ˜¯å¦è·¨ç­ |
| check_in_time | DATETIME | ç­¾åˆ°æ—¶é—´ |
| is_deleted | INT | è½¯åˆ é™¤æ ‡è®° |
| create_time | DATETIME | åˆ›å»ºæ—¶é—´ |
| update_time | DATETIME | æ›´æ–°æ—¶é—´ |

#### class_photos - è¯¾å ‚ç…§ç‰‡è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | BIGINT | ä¸»é”® |
| course_id | VARCHAR(50) | è¯¾ç¨‹ID |
| student_username | VARCHAR(50) | å­¦ç”Ÿç”¨æˆ·å |
| photo_path | VARCHAR(500) | ç…§ç‰‡è·¯å¾„ |
| compressed_path | VARCHAR(500) | å‹ç¼©è·¯å¾„ |
| upload_time | DATETIME | ä¸Šä¼ æ—¶é—´ |
| is_deleted | INT | è½¯åˆ é™¤æ ‡è®° |
| create_time | DATETIME | åˆ›å»ºæ—¶é—´ |
| update_time | DATETIME | æ›´æ–°æ—¶é—´ |

#### papers - è¯•å·è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | BIGINT | ä¸»é”® |
| name | VARCHAR(200) | è¯•å·åç§° |
| description | TEXT | æè¿° |
| is_questionnaire | INT | æ˜¯å¦é—®å· |
| is_deleted | INT | è½¯åˆ é™¤æ ‡è®° |
| create_time | DATETIME | åˆ›å»ºæ—¶é—´ |
| update_time | DATETIME | æ›´æ–°æ—¶é—´ |

#### topics - é¢˜ç›®è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | BIGINT | ä¸»é”® |
| paper_id | BIGINT | è¯•å·ID |
| type | INT | é¢˜ç›®ç±»å‹ |
| content | TEXT | é¢˜ç›®å†…å®¹ |
| options | TEXT | é€‰é¡¹ |
| correct_answer | TEXT | æ­£ç¡®ç­”æ¡ˆ |
| score | DECIMAL | åˆ†å€¼ |
| is_deleted | INT | è½¯åˆ é™¤æ ‡è®° |
| create_time | DATETIME | åˆ›å»ºæ—¶é—´ |
| update_time | DATETIME | æ›´æ–°æ—¶é—´ |

**é¢˜ç›®ç±»å‹è¯´æ˜ï¼š**
- 1 - å•é€‰é¢˜
- 2 - å¤šé€‰é¢˜
- 3 - åˆ¤æ–­é¢˜
- 4 - å¡«ç©ºé¢˜
- 5 - ç®€ç­”é¢˜
- 6 - å…¶ä»–

### æ•°æ®åº“ç‰¹æ€§

- **è½¯åˆ é™¤** - æ‰€æœ‰è¡¨éƒ½æœ‰ `is_deleted` å­—æ®µ
- **è‡ªåŠ¨æ—¶é—´æˆ³** - `create_time`, `update_time`
- **å”¯ä¸€çº¦æŸ** - é˜²æ­¢é‡å¤æ•°æ®
- **ç´¢å¼•ä¼˜åŒ–** - æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–

---

## APIæ–‡æ¡£

### è®¤è¯ç›¸å…³ `/api/auth`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/login` | ç”¨æˆ·ç™»å½• |
| POST | `/set-password` | è®¾ç½®å¯†ç  |
| POST | `/reset-password` | ç®¡ç†å‘˜é‡ç½®å¯†ç  |
| GET | `/check-user/{username}` | æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨ |
| GET | `/check-user-status/{username}` | æ£€æŸ¥ç”¨æˆ·çŠ¶æ€ |
| GET | `/wechat-status/{username}` | æ£€æŸ¥å¾®ä¿¡ç»‘å®šçŠ¶æ€ |
| POST | `/unbind-wechat` | è§£ç»‘å¾®ä¿¡ |
| POST | `/login-by-openid` | å¾®ä¿¡OpenIDç™»å½• |
| POST | `/login-by-code` | å¾®ä¿¡Codeç™»å½• |
| GET | `/wechat-callback` | å¾®ä¿¡æœåŠ¡å™¨éªŒè¯ |

### æ•™å¸ˆç«¯ `/api/teacher`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/courses` | è·å–ä»Šæ—¥è¯¾ç¨‹ |
| GET | `/courses/all` | è·å–æ‰€æœ‰è¯¾ç¨‹ |
| GET | `/courses/by-date` | æŒ‰æ—¥æœŸæŸ¥è¯¢è¯¾ç¨‹ |
| POST | `/attendance/qr` | ç”Ÿæˆç­¾åˆ°äºŒç»´ç  |
| POST | `/attendance/qr/universal` | ç”Ÿæˆé€šç”¨ç­¾åˆ°äºŒç»´ç  |
| GET | `/attendance/stats` | è·å–ç­¾åˆ°ç»Ÿè®¡ |
| GET | `/attendance/absent-students` | è·å–æœªç­¾åˆ°å­¦ç”Ÿ |
| GET | `/attendance/course/{courseId}` | æŸ¥çœ‹è¯¾ç¨‹ç­¾åˆ°æƒ…å†µ |
| PUT | `/attendance/update` | ä¿®æ”¹å­¦ç”Ÿç­¾åˆ°çŠ¶æ€ |
| GET | `/photos/course/{courseId}` | è·å–è¯¾å ‚ç…§ç‰‡ |
| GET | `/students` | è·å–å­¦ç”Ÿåˆ—è¡¨ |
| POST | `/import/students` | å¯¼å…¥å­¦ç”Ÿæ•°æ® |
| POST | `/import/courses` | å¯¼å…¥è¯¾ç¨‹æ•°æ® |
| GET | `/template/students` | ä¸‹è½½å­¦ç”Ÿæ¨¡æ¿ |
| GET | `/template/courses` | ä¸‹è½½è¯¾ç¨‹æ¨¡æ¿ |
| POST | `/multi-class/configure` | é…ç½®å¤šç­çº§è¯¾ç¨‹ |
| GET | `/multi-class/info/{courseId}` | è·å–å¤šç­çº§è¯¾ç¨‹ä¿¡æ¯ |

### å­¦ç”Ÿç«¯ `/api/student`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/attendance/scan` | æ‰«ç ç­¾åˆ° |
| GET | `/attendance/records` | è·å–ç­¾åˆ°è®°å½• |
| GET | `/attendance/stats` | è·å–ç­¾åˆ°ç»Ÿè®¡ |
| POST | `/bind-class` | ç»‘å®šç­çº§ |
| GET | `/classes` | è·å–ç­çº§åˆ—è¡¨ |
| POST | `/photo/upload` | ä¸Šä¼ è¯¾å ‚ç…§ç‰‡ |
| GET | `/photos` | è·å–ç…§ç‰‡åˆ—è¡¨ |
| GET | `/photos/course/{courseId}` | è·å–è¯¾ç¨‹ç…§ç‰‡ |
| DELETE | `/photo/{photoId}` | åˆ é™¤ç…§ç‰‡ |
| GET | `/notes/word/{courseId}` | ç”ŸæˆWordæ–‡æ¡£ |
| GET | `/download/word/{fileName}` | ä¸‹è½½Wordæ–‡æ¡£ |
| GET | `/courses` | è·å–è¯¾ç¨‹åˆ—è¡¨ |
| GET | `/current-courses` | è·å–å½“å‰è¯¾ç¨‹ |
| GET | `/recent-courses` | è·å–æœ€è¿‘è¯¾ç¨‹ |
| GET | `/last-attendance` | è·å–æœ€è¿‘ç­¾åˆ°è®°å½• |
| GET | `/attended-courses` | è·å–å·²ç­¾åˆ°è¯¾ç¨‹ |

### ä½œä¸šç®¡ç† `/api/assignment`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/upload` | ä¸Šä¼ ä½œä¸š |
| GET | `/my-submissions` | æŸ¥çœ‹æˆ‘çš„ä½œä¸š |
| GET | `/course/{courseId}/submissions` | æŸ¥çœ‹è¯¾ç¨‹ä½œä¸š |
| POST | `/review/{submissionId}` | æ‰¹æ”¹ä½œä¸š |
| GET | `/download/{fileName}` | ä¸‹è½½ä½œä¸šæ–‡ä»¶ |

### è¯¾ç¨‹æˆç»© `/api/course-grades`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/grade` | ç»™å­¦ç”Ÿæ‰“åˆ† |
| GET | `/student/{studentCode}/course/{courseId}` | è·å–å­¦ç”Ÿæˆç»© |
| GET | `/course/{courseId}` | è·å–è¯¾ç¨‹æˆç»©åˆ—è¡¨ |
| GET | `/my-grades` | è·å–æˆ‘çš„æˆç»© |

### å¾®ä¿¡é€šçŸ¥ `/api/wechat`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/send-class-reminder` | å‘é€ä¸Šè¯¾æé†’ |
| POST | `/send-personal-reminder` | å‘é€ä¸ªäººæé†’ |
| POST | `/send-manual-message` | å‘é€æ‰‹åŠ¨æ¶ˆæ¯ |
| POST | `/send-batch-message` | æ‰¹é‡å‘é€æ¶ˆæ¯ |
| POST | `/test-wechat-code` | æµ‹è¯•å¾®ä¿¡code |
| POST | `/send-simple-test` | å‘é€ç®€å•æµ‹è¯•æ¶ˆæ¯ |

### å…¬å…±æ¥å£ `/api/public`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/photo/{photoId}` | æŸ¥çœ‹ç…§ç‰‡ï¼ˆæ— éœ€è®¤è¯ï¼‰ |

### å¥åº·æ£€æŸ¥ `/api/health`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/check` | å¥åº·æ£€æŸ¥ |
| POST | `/check` | POSTå¥åº·æ£€æŸ¥ |
| GET | `/test-excel` | ExcelåŠŸèƒ½æµ‹è¯• |

### æœªç­¾åˆ°å­¦ç”ŸæŸ¥è¯¢ `/api/absent-students`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/get/{date}` | è·å–æŒ‡å®šæ—¥æœŸæœªç­¾åˆ°å­¦ç”Ÿ |
| GET | `/range` | è·å–æ—¥æœŸèŒƒå›´å†…æœªç­¾åˆ°å­¦ç”Ÿ |

---

## æ ¸å¿ƒåŠŸèƒ½

### 1. ç”¨æˆ·è®¤è¯ä¸æˆæƒ

#### JWTè®¤è¯æµç¨‹

```
ç”¨æˆ·ç™»å½• â†’ éªŒè¯ç”¨æˆ·åå¯†ç  â†’ ç”ŸæˆJWT Token â†’ è¿”å›Token
åç»­è¯·æ±‚ â†’ æºå¸¦Token â†’ JwtAuthenticationFilteréªŒè¯ â†’ æ”¾è¡Œ/æ‹’ç»
```

#### è§’è‰²éªŒè¯ç³»ç»Ÿ

ä½¿ç”¨AOPå®ç°å£°æ˜å¼è§’è‰²éªŒè¯ï¼š

```java
@RequireRole(UserRole.TEACHER)
public ApiResponse<?> getTodayCourses() {
    // åªæœ‰æ•™å¸ˆè§’è‰²å¯ä»¥è®¿é—®
}
```

**æ”¯æŒçš„è§’è‰²ï¼š**
- `ADMIN` - ç®¡ç†å‘˜
- `TEACHER` - æ•™å¸ˆ
- `STUDENT` - å­¦ç”Ÿ

### 2. å­¦ç”Ÿç­¾åˆ°ç³»ç»Ÿ

#### ç­¾åˆ°æµç¨‹

```
æ•™å¸ˆç”ŸæˆäºŒç»´ç  â†’ å­¦ç”Ÿæ‰«ç  â†’ éªŒè¯è¯¾ç¨‹æœ‰æ•ˆæ€§ â†’ è®°å½•ç­¾åˆ° â†’ è¿”å›ç»“æœ
```

#### æ”¯æŒè·¨ç­ç­¾åˆ°

é€šè¿‡ `multi_class_courses` è¡¨é…ç½®å¤šç­çº§è¯¾ç¨‹ï¼Œç­¾åˆ°è®°å½•è¡¨åŒ…å« `is_cross_class` å’Œ `student_actual_class_code` å­—æ®µã€‚

### 3. è¯¾å ‚ç…§ç‰‡ç®¡ç†

#### ç…§ç‰‡ä¸Šä¼ æµç¨‹

```
å­¦ç”Ÿä¸Šä¼ ç…§ç‰‡ â†’ æ–‡ä»¶éªŒè¯ â†’ å‹ç¼©å¤„ç† â†’ ä¿å­˜åŸå›¾å’Œå‹ç¼©å›¾ â†’ è®°å½•æ•°æ®åº“
```

#### æ–‡ä»¶å­˜å‚¨ç»“æ„

```
uploads/signlab/photos/{year}/{month}/{day}/{course_name}/{timestamp}_{username}.jpg
```

### 4. ä½œä¸šæäº¤ç³»ç»Ÿ

#### ä½œä¸šç±»å‹

- `class_notes` - è¯¾å ‚ç¬”è®°
- `homework` - ä½œä¸š
- `report` - æŠ¥å‘Š

#### æäº¤çŠ¶æ€

- `draft` - è‰ç¨¿
- `submitted` - å·²æäº¤
- `reviewed` - å·²æ‰¹æ”¹
- `returned` - å·²é€€å›

### 5. é—®å·/è¯•å·ç³»ç»Ÿ

#### é¢˜ç›®ç±»å‹

- 1 - å•é€‰é¢˜
- 2 - å¤šé€‰é¢˜
- 3 - åˆ¤æ–­é¢˜
- 4 - å¡«ç©ºé¢˜
- 5 - ç®€ç­”é¢˜
- 6 - å…¶ä»–

#### å¡«ç©ºé¢˜æ”¯æŒ

- **å•ç©ºæ ¼å¼**ï¼šç›´æ¥å¡«å†™ç­”æ¡ˆ
- **å¤šç©ºæ ¼å¼**ï¼š`1:ç­”æ¡ˆ1$2:ç­”æ¡ˆ2$3:ç­”æ¡ˆ3`

### 6. å¾®ä¿¡å…¬ä¼—å·é›†æˆ

#### å¾®ä¿¡åŠŸèƒ½

- å¾®ä¿¡ç™»å½•
- ä¸Šè¯¾æé†’é€šçŸ¥
- æ‰‹åŠ¨æ¶ˆæ¯å‘é€
- æ‰¹é‡æ¶ˆæ¯å‘é€

#### å¾®ä¿¡å­—æ®µ (`users`è¡¨)

- `wx_openid` - å¾®ä¿¡OpenID
- `wx_unionid` - å¾®ä¿¡UnionID
- `wx_nickname` - å¾®ä¿¡æ˜µç§°
- `wx_avatar` - å¾®ä¿¡å¤´åƒ
- `wx_bind_time` - ç»‘å®šæ—¶é—´

---

## å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
signLab1/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/com/signlab1/
â”‚   â”‚   â”‚   â”œâ”€â”€ annotation/          # è‡ªå®šä¹‰æ³¨è§£
â”‚   â”‚   â”‚   â”œâ”€â”€ aspect/              # AOPåˆ‡é¢
â”‚   â”‚   â”‚   â”œâ”€â”€ config/              # é…ç½®ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ controller/          # æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ enums/               # æšä¸¾ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ exception/           # å¼‚å¸¸å¤„ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ filter/              # è¿‡æ»¤å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ interceptor/         # æ‹¦æˆªå™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ mapper/              # æ•°æ®è®¿é—®å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ pojo/                # å®ä½“ç±»
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ dto/             # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ entity/          # æ•°æ®åº“å®ä½“
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ vo/              # è§†å›¾å¯¹è±¡
â”‚   â”‚   â”‚   â”œâ”€â”€ service/             # æœåŠ¡å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ util/                # å·¥å…·ç±»
â”‚   â”‚   â”‚   â””â”€â”€ SignLab1Application.java
â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚       â”œâ”€â”€ application.yml
â”‚   â”‚       â”œâ”€â”€ application-prod.yml
â”‚   â”‚       â””â”€â”€ mapper/              # MyBatisæ˜ å°„æ–‡ä»¶
â”‚   â””â”€â”€ test/
â”‚       â””â”€â”€ java/com/signlab1/       # æµ‹è¯•ä»£ç 
â”œâ”€â”€ database/                        # æ•°æ®åº“è„šæœ¬
â”œâ”€â”€ documentation/                   # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ python-scripts/                  # Pythonæµ‹è¯•è„šæœ¬
â”œâ”€â”€ uploads/                         # ä¸Šä¼ æ–‡ä»¶ç›®å½•
â”œâ”€â”€ pom.xml                          # Mavené…ç½®
â””â”€â”€ README.md                        # é¡¹ç›®æ–‡æ¡£
```

### ä»£ç è§„èŒƒ

#### å‘½åè§„èŒƒ

- **ç±»å**ï¼šå¤§é©¼å³°å‘½åæ³•ï¼ˆPascalCaseï¼‰
- **æ–¹æ³•å**ï¼šå°é©¼å³°å‘½åæ³•ï¼ˆcamelCaseï¼‰
- **å¸¸é‡å**ï¼šå…¨å¤§å†™ä¸‹åˆ’çº¿åˆ†éš”ï¼ˆUPPER_SNAKE_CASEï¼‰
- **å˜é‡å**ï¼šå°é©¼å³°å‘½åæ³•ï¼ˆcamelCaseï¼‰

#### æ³¨é‡Šè§„èŒƒ

```java
/**
 * ç”¨æˆ·æœåŠ¡ç±»
 * 
 * @author SignLab Team
 * @since 1.0.0
 */
@Service
public class UserService {
    
    /**
     * æ ¹æ®ç”¨æˆ·åè·å–ç”¨æˆ·ä¿¡æ¯
     * 
     * @param username ç”¨æˆ·å
     * @return ç”¨æˆ·ä¿¡æ¯
     * @throws UserNotFoundException ç”¨æˆ·ä¸å­˜åœ¨å¼‚å¸¸
     */
    public User getUserByUsername(String username) {
        // å®ç°ä»£ç 
    }
}
```

### æ·»åŠ æ–°åŠŸèƒ½

#### 1. åˆ›å»ºå®ä½“ç±»

```java
package com.signlab1.pojo.entity;

import com.baomidou.mybatisplus.annotation.*;
import lombok.Data;
import java.time.LocalDateTime;

@Data
@TableName("your_table_name")
public class YourEntity {
    
    @TableId(type = IdType.AUTO)
    private Long id;
    
    private String name;
    
    @TableLogic
    private Integer isDeleted;
    
    @TableField(fill = FieldFill.INSERT)
    private LocalDateTime createTime;
    
    @TableField(fill = FieldFill.INSERT_UPDATE)
    private LocalDateTime updateTime;
}
```

#### 2. åˆ›å»ºMapperæ¥å£

```java
package com.signlab1.mapper;

import com.baomidou.mybatisplus.core.mapper.BaseMapper;
import com.signlab1.pojo.entity.YourEntity;
import org.apache.ibatis.annotations.Mapper;

@Mapper
public interface YourMapper extends BaseMapper<YourEntity> {
}
```

#### 3. åˆ›å»ºServiceæ¥å£å’Œå®ç°

```java
package com.signlab1.service;

import com.signlab1.pojo.entity.YourEntity;

public interface YourService {
    YourEntity getById(Long id);
    void save(YourEntity entity);
}
```

```java
package com.signlab1.service.impl;

import com.signlab1.mapper.YourMapper;
import com.signlab1.pojo.entity.YourEntity;
import com.signlab1.service.YourService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

@Service
public class YourServiceImpl implements YourService {
    
    @Autowired
    private YourMapper yourMapper;
    
    @Override
    public YourEntity getById(Long id) {
        return yourMapper.selectById(id);
    }
    
    @Override
    public void save(YourEntity entity) {
        yourMapper.insert(entity);
    }
}
```

#### 4. åˆ›å»ºController

```java
package com.signlab1.controller;

import com.signlab1.annotation.RequireRole;
import com.signlab1.enums.UserRole;
import com.signlab1.pojo.dto.ApiResponse;
import com.signlab1.pojo.entity.YourEntity;
import com.signlab1.service.YourService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/your-resource")
@RequireRole(UserRole.TEACHER)
public class YourController {
    
    @Autowired
    private YourService yourService;
    
    @GetMapping("/{id}")
    public ApiResponse<YourEntity> getById(@PathVariable Long id) {
        YourEntity entity = yourService.getById(id);
        return ApiResponse.success(entity, "æŸ¥è¯¢æˆåŠŸ");
    }
    
    @PostMapping
    public ApiResponse<Void> save(@RequestBody YourEntity entity) {
        yourService.save(entity);
        return ApiResponse.success(null, "ä¿å­˜æˆåŠŸ");
    }
}
```

### ä½¿ç”¨AOPè§’è‰²éªŒè¯

```java
package com.signlab1.controller;

import com.signlab1.annotation.RequireRole;
import com.signlab1.enums.UserRole;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/protected")
@RequireRole(UserRole.TEACHER) // ç±»çº§åˆ«è§’è‰²éªŒè¯
public class ProtectedController {
    
    @GetMapping("/data")
    @RequireRole(UserRole.ADMIN) // æ–¹æ³•çº§åˆ«è§’è‰²éªŒè¯ï¼ˆè¦†ç›–ç±»çº§åˆ«ï¼‰
    public ApiResponse<?> getData() {
        // åªæœ‰ADMINè§’è‰²å¯ä»¥è®¿é—®
    }
    
    @GetMapping("/info")
    public ApiResponse<?> getInfo() {
        // TEACHERå’ŒADMINè§’è‰²éƒ½å¯ä»¥è®¿é—®
    }
}
```

### å¼‚å¸¸å¤„ç†

```java
package com.signlab1.exception;

import lombok.Getter;

@Getter
public class BusinessException extends RuntimeException {
    private final Integer code;
    
    public BusinessException(String message) {
        super(message);
        this.code = 500;
    }
    
    public BusinessException(Integer code, String message) {
        super(message);
        this.code = code;
    }
}
```

### é€šç”¨å“åº”DTO

```java
package com.signlab1.pojo.dto;

import lombok.Data;
import java.time.LocalDateTime;

@Data
public class ApiResponse<T> {
    private Integer code;
    private String message;
    private T data;
    private Long timestamp;
    
    public static <T> ApiResponse<T> success(T data, String message) {
        ApiResponse<T> response = new ApiResponse<>();
        response.setCode(200);
        response.setMessage(message);
        response.setData(data);
        response.setTimestamp(System.currentTimeMillis());
        return response;
    }
    
    public static <T> ApiResponse<T> error(String message) {
        ApiResponse<T> response = new ApiResponse<>();
        response.setCode(500);
        response.setMessage(message);
        response.setTimestamp(System.currentTimeMillis());
        return response;
    }
}
```

---

## æµ‹è¯•æŒ‡å—

### Pythonæµ‹è¯•æ¡†æ¶

é¡¹ç›®æä¾›äº†å®Œæ•´çš„Pythonæµ‹è¯•æ¡†æ¶ï¼Œä½äº `python-scripts/` ç›®å½•ã€‚

### æµ‹è¯•è„šæœ¬ç»“æ„

```
python-scripts/
â”œâ”€â”€ config.yaml                    # é…ç½®æ–‡ä»¶
â”œâ”€â”€ jwt_manager.py                 # JWTä»¤ç‰Œç®¡ç†
â”œâ”€â”€ api_client.py                  # APIå®¢æˆ·ç«¯åŸºç±»
â”œâ”€â”€ questionnaire_client.py        # é—®å·APIå®¢æˆ·ç«¯
â”œâ”€â”€ auto_test.py                   # è‡ªåŠ¨æµ‹è¯•è„šæœ¬
â””â”€â”€ questionnaire/
    â”œâ”€â”€ api_client.log             # APIè°ƒç”¨æ—¥å¿—
    â”œâ”€â”€ api_client.py              # é—®å·APIå®¢æˆ·ç«¯
    â”œâ”€â”€ auto_test.py               # é—®å·è‡ªåŠ¨æµ‹è¯•
    â”œâ”€â”€ full_auto_test.py          # å®Œæ•´è‡ªåŠ¨æµ‹è¯•
    â”œâ”€â”€ jwt_manager.py             # JWTä»¤ç‰Œç®¡ç†
    â”œâ”€â”€ jwt_tokens.json            # JWTä»¤ç‰Œå­˜å‚¨
    â”œâ”€â”€ main.py                    # ä¸»ç¨‹åº
    â”œâ”€â”€ test_all_apis.py           # æµ‹è¯•æ‰€æœ‰API
    â””â”€â”€ test_role_permission.py    # æµ‹è¯•è§’è‰²æƒé™
```

### å®‰è£…ä¾èµ–

```bash
cd python-scripts
pip install -r requirements.txt
```

### é…ç½®æµ‹è¯•ç¯å¢ƒ

ç¼–è¾‘ `config.yaml`ï¼š

```yaml
server:
  base_url: http://localhost:8085
  timeout: 30

auth:
  username: test_teacher
  password: test_password

jwt:
  file_path: jwt_tokens.json
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡ŒåŸºç¡€æµ‹è¯•
python auto_test.py

# è¿è¡Œé—®å·æµ‹è¯•
python questionnaire/full_auto_test.py

# è¿è¡Œè§’è‰²æƒé™æµ‹è¯•
python questionnaire/test_role_permission.py

# è¿è¡Œæ‰€æœ‰APIæµ‹è¯•
python questionnaire/test_all_apis.py
```

### æµ‹è¯•è¦†ç›–

- âœ… ç”¨æˆ·ç™»å½•
- âœ… JWTä»¤ç‰Œç®¡ç†
- âœ… é—®å·é¢˜ç›®åˆ›å»º
- âœ… å­¦ç”Ÿç­”æ¡ˆæäº¤
- âœ… ç»Ÿè®¡æŸ¥è¯¢
- âœ… è§’è‰²æƒé™éªŒè¯

### Javaå•å…ƒæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
mvn test

# è¿è¡Œç‰¹å®šæµ‹è¯•ç±»
mvn test -Dtest=YourTestClass

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–¹æ³•
mvn test -Dtest=YourTestClass#testMethod
```

---

## éƒ¨ç½²æŒ‡å—

### ç”Ÿäº§ç¯å¢ƒé…ç½®

#### 1. é…ç½®æ–‡ä»¶

ä½¿ç”¨ `application-prod.yml`ï¼š

```yaml
spring:
  datasource:
    url: jdbc:mysql://43.139.186.204:3306/signlab1
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}

file:
  upload:
    path: /opt/signlab/uploads/

jwt:
  expiration: 2592000  # 30å¤©

server:
  port: 8085
  address: 0.0.0.0
```

#### 2. ç¯å¢ƒå˜é‡

è®¾ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡ï¼š

```bash
export DB_HOST=43.139.186.204
export DB_PORT=3306
export DB_NAME=signlab1
export DB_USERNAME=your_username
export DB_PASSWORD=your_password
export UPLOAD_PATH=/opt/signlab/uploads/
export JWT_SECRET=your_jwt_secret
export JWT_EXPIRATION=2592000
export SERVER_PORT=8085
export SERVER_ADDRESS=0.0.0.0
export WECHAT_APPID=your_wechat_appid
export WECHAT_SECRET=your_wechat_secret
export WECHAT_TEMPLATE_ID=your_template_id
export WECHAT_TOKEN=your_wechat_token
```

#### 3. æ„å»ºåº”ç”¨

```bash
mvn clean package -DskipTests
```

#### 4. éƒ¨ç½²åº”ç”¨

**ä½¿ç”¨Javaå‘½ä»¤ï¼š**
```bash
java -jar target/signlab1-1.0.0.jar --spring.profiles.active=prod
```

**ä½¿ç”¨Dockerï¼š**
```dockerfile
FROM openjdk:17-jdk-slim
WORKDIR /app
COPY target/signlab1-1.0.0.jar app.jar
EXPOSE 8085
ENTRYPOINT ["java", "-jar", "app.jar", "--spring.profiles.active=prod"]
```

```bash
docker build -t signlab1 .
docker run -d -p 8085:8085 --name signlab1 signlab1
```

#### 5. é…ç½®Nginxåå‘ä»£ç†

```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:8085;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

#### 6. é…ç½®SSLè¯ä¹¦

```nginx
server {
    listen 443 ssl;
    server_name your-domain.com;

    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;

    location / {
        proxy_pass http://localhost:8085;
        # ... å…¶ä»–é…ç½®
    }
}
```

### CI/CD

é¡¹ç›®åŒ…å«GitHub Actionså·¥ä½œæµé…ç½® `.github/workflows/ci-cd.yml`ã€‚

---

## å¸¸è§é—®é¢˜

### 1. å¦‚ä½•é‡ç½®ç”¨æˆ·å¯†ç ï¼Ÿ

ç®¡ç†å‘˜å¯ä»¥é€šè¿‡APIé‡ç½®ç”¨æˆ·å¯†ç ï¼š

```bash
POST /api/auth/reset-password
{
  "username": "student001",
  "newPassword": "newPassword123"
}
```

### 2. å¦‚ä½•é…ç½®å¤šç­çº§è¯¾ç¨‹ï¼Ÿ

æ•™å¸ˆå¯ä»¥é€šè¿‡APIé…ç½®ï¼š

```bash
POST /api/teacher/multi-class/configure
{
  "courseId": "CS101_20260124",
  "classCodes": ["CS101_A", "CS101_B", "CS101_C"]
}
```

### 3. å¦‚ä½•ç”Ÿæˆç­¾åˆ°äºŒç»´ç ï¼Ÿ

æ•™å¸ˆå¯ä»¥é€šè¿‡APIç”Ÿæˆï¼š

```bash
POST /api/teacher/attendance/qr
{
  "courseId": "CS101_20260124"
}
```

### 4. å¦‚ä½•ä¸Šä¼ è¯¾å ‚ç…§ç‰‡ï¼Ÿ

å­¦ç”Ÿå¯ä»¥é€šè¿‡APIä¸Šä¼ ï¼š

```bash
POST /api/student/photo/upload
Content-Type: multipart/form-data

file: [ç…§ç‰‡æ–‡ä»¶]
courseId: CS101_20260124
```

### 5. å¦‚ä½•ç»‘å®šå¾®ä¿¡è´¦å·ï¼Ÿ

ç”¨æˆ·å¯ä»¥é€šè¿‡å¾®ä¿¡å°ç¨‹åºæˆ–å…¬ä¼—å·ç»‘å®šï¼š

```bash
POST /api/auth/login-by-code
{
  "code": "å¾®ä¿¡æˆæƒç "
}
```

### 6. å¦‚ä½•æŸ¥çœ‹ç­¾åˆ°ç»Ÿè®¡ï¼Ÿ

æ•™å¸ˆå¯ä»¥é€šè¿‡APIæŸ¥çœ‹ï¼š

```bash
GET /api/teacher/attendance/stats?courseId=CS101_20260124
```

### 7. å¦‚ä½•æ‰¹æ”¹ä½œä¸šï¼Ÿ

æ•™å¸ˆå¯ä»¥é€šè¿‡APIæ‰¹æ”¹ï¼š

```bash
POST /api/assignment/review/{submissionId}
{
  "comment": "ä½œä¸šå®Œæˆå¾—å¾ˆå¥½",
  "score": 95
}
```

### 8. å¦‚ä½•å‘é€å¾®ä¿¡é€šçŸ¥ï¼Ÿ

æ•™å¸ˆå¯ä»¥é€šè¿‡APIå‘é€ï¼š

```bash
POST /api/wechat/send-class-reminder
{
  "courseId": "CS101_20260124",
  "message": "è¯·è®°å¾—å‡†æ—¶ä¸Šè¯¾"
}
```

### 9. å¦‚ä½•å¯¼å‡ºå­¦ç”Ÿæ•°æ®ï¼Ÿ

æ•™å¸ˆå¯ä»¥é€šè¿‡APIå¯¼å‡ºï¼š

```bash
GET /api/teacher/template/students
```

### 10. å¦‚ä½•é…ç½®è‡ªåŠ¨å»ºè¡¨ï¼Ÿ

ä½¿ç”¨AutoTableæ³¨è§£ï¼š

```java
@Data
@TableName("your_table")
@AutoTable
public class YourEntity {
    // å­—æ®µå®šä¹‰
}
```

---

## é¡¹ç›®ç‰¹è‰²

1. **è‡ªåŠ¨å»ºè¡¨** - ä½¿ç”¨AutoTableæ³¨è§£è‡ªåŠ¨åˆ›å»ºæ•°æ®åº“è¡¨
2. **AOPè§’è‰²éªŒè¯** - å£°æ˜å¼æƒé™æ§åˆ¶ï¼Œä»£ç ç®€æ´
3. **JWTæ— çŠ¶æ€è®¤è¯** - æ”¯æŒè·¨åŸŸè¯·æ±‚
4. **å¾®ä¿¡é›†æˆ** - æ”¯æŒå¾®ä¿¡å…¬ä¼—å·ç™»å½•å’Œé€šçŸ¥
5. **å¤šç­çº§æ”¯æŒ** - æ”¯æŒè·¨ç­ç­¾åˆ°
6. **å›¾ç‰‡å‹ç¼©** - è‡ªåŠ¨å‹ç¼©ä¸Šä¼ çš„å›¾ç‰‡
7. **Wordæ–‡æ¡£ç”Ÿæˆ** - è‡ªåŠ¨ç”Ÿæˆè¯¾å ‚ç¬”è®°Wordæ–‡æ¡£
8. **äºŒç»´ç ç­¾åˆ°** - æ•™å¸ˆç”ŸæˆäºŒç»´ç ï¼Œå­¦ç”Ÿæ‰«ç ç­¾åˆ°
9. **é—®å·ç³»ç»Ÿ** - æ”¯æŒå¤šç§é¢˜å‹ï¼ˆå•é€‰ã€å¤šé€‰ã€å¡«ç©ºã€ç®€ç­”ï¼‰
10. **Pythonæµ‹è¯•æ¡†æ¶** - å®Œæ•´çš„APIæµ‹è¯•è„šæœ¬

---

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿã€‚

---

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚

---

**æœ€åæ›´æ–°æ—¶é—´ï¼š2026å¹´1æœˆ24æ—¥**